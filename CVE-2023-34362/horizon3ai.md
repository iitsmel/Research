---
markmap:
  colorFreezeLevel: 3
  initialExpandLevel: 2
---

# horizon3ai PoC

## step 1. get_session_id()
- Send GET request and extract ASP.NET_SessionId from the response cookies

## step 2. set_session_variables()
- Create headers for setting session variables
- Send POST request to MOVEitISAPI.dll to set session variables

## step 3. get_csrf()
- Send POST request to guestaccess.aspx with "Arg06" and extract CSRF token from the response

## step 4. do_injection()
- Iterate over SQL statements and create according headers
- Send POST request to guestaccess.aspx with data that can triggger SQL injection

## step 5. create_jwt()
- Sign JWT using private key and headers
  - private key from key.pem file
  - certificate from cert.crt file and EDR form of the certificate
  - Compute SHA-1 hash of the certificate
  - Base64url encode the hash
  - Define JWT headers with x5t value


## step 6. get_access_token()
- Send POST request to access_token endpoint with encoded JWT
- Extract access token from the response

## step 7. do_injection()
- Send POST request to guestaccess.aspx to delete the uploaded file

## step 8. get_folder_id()
- Send POST request to guestaccess.aspx to get the folder ID
- Extract folder ID from the response

## step 9. start_upload()
- Send POST request to guestaccess.aspx for file uploading

## step 10. inject_payload()
- Inject with the ysoserial .NET payload
- Check if the response shows "Internal Server Error"